import{j as e,u as f,r as m,v,m as w,U as N,C as k,t as _,d as C,w as D,o as z}from"./ui-E6zqGgdH.js";import{r as l,a as E}from"./router-CLvrYEWH.js";import{s as x}from"./index-BSxhl5io.js";import{B as S}from"./Breadcrumb-DhjgP5dH.js";import"./vendor-RGnvvjkK.js";const O=()=>{const[i,n]=l.useState([]),[b,g]=l.useState(!0),[h,d]=l.useState(""),a=E();l.useEffect(()=>{u()},[]);const u=async()=>{try{g(!0);const{data:s,error:t}=await x.from("blog_posts").select("*").order("published_at",{ascending:!1}).order("created_at",{ascending:!1});if(t)throw t;const r=(s||[]).sort((o,c)=>{const j=o.published_at?new Date(o.published_at):new Date(o.created_at);return(c.published_at?new Date(c.published_at):new Date(c.created_at)).getTime()-j.getTime()});n(r)}catch(s){d("포스트를 불러오는데 실패했습니다."),console.error("Error fetching posts:",s)}finally{g(!1)}},p=async s=>{if(confirm("정말로 이 포스트를 삭제하시겠습니까?"))try{const{error:t}=await x.from("blog_posts").delete().eq("id",s);if(t)throw t;n(i.filter(r=>r.id!==s))}catch(t){d("포스트 삭제에 실패했습니다."),console.error("Error deleting post:",t)}},y=async s=>{try{const{error:t}=await x.from("blog_posts").update({is_published:!s.is_published,published_at:s.is_published?null:new Date().toISOString()}).eq("id",s.id);if(t)throw t;n(i.map(r=>r.id===s.id?{...r,is_published:!r.is_published}:r))}catch(t){d("포스트 상태 변경에 실패했습니다."),console.error("Error updating post:",t)}};return b?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{children:e.jsx(S,{items:[{label:"블로그 관리",path:"/admin/blog"}]})}),e.jsxs("div",{className:"flex justify-between items-center pb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"블로그 관리"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>a("/admin"),className:"flex items-center gap-2 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(f,{size:16}),"대시보드"]}),e.jsxs("button",{onClick:()=>a("/admin/blog/categories"),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(m,{size:16}),"포스트 카테고리"]}),e.jsxs("button",{onClick:()=>a("/admin/blog/new"),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(v,{size:16}),"새 포스트"]})]})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[h&&e.jsx("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded-md",children:h}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["포스트 목록 (",i.length,")"]})}),i.length===0?e.jsxs("div",{className:"px-6 py-12 text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"아직 포스트가 없습니다."}),e.jsx("button",{onClick:()=>a("/admin/blog/new"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"첫 포스트 작성하기"})]}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:i.map(s=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors",onClick:()=>a(`/blog/${s.post_no}`),title:"포스트 보기",children:s.title}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.is_published?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}`,children:s.is_published?"발행됨":"임시저장"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{size:14}),s.author]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{size:14}),new Date(s.created_at).toLocaleDateString()]}),s.tags&&s.tags.length>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{size:14}),s.tags.join(", ")]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>y(s),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",title:s.is_published?"발행 취소":"발행",children:s.is_published?e.jsx(_,{size:16}):e.jsx(C,{size:16})}),e.jsx("button",{onClick:()=>a(`/admin/blog/edit/${s.id}`),className:"p-2 text-blue-600 hover:text-blue-700 transition-colors",title:"편집",children:e.jsx(D,{size:16})}),e.jsx("button",{onClick:()=>p(s.id),className:"p-2 text-red-600 hover:text-red-700 transition-colors",title:"삭제",children:e.jsx(z,{size:16})})]})]})},s.id))})]})]})]})};export{O as default};
