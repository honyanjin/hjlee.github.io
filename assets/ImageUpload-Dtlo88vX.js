import{j as e,X as z,_ as f,g as I,a3 as S}from"./ui-DZss5j7o.js";import{r as s}from"./router-CLvrYEWH.js";import{e as $,s as y}from"./index-D65f1dRP.js";const O=({onImageUpload:o,currentImage:c,className:j="",bucketName:a="blog-images"})=>{const[v,d]=s.useState(!1),[N,n]=s.useState(!1),[x,l]=s.useState(""),g=s.useRef(null),[E,P]=s.useState(!1),p=async t=>{if(t){if(t.size>5*1024*1024){l("파일 크기는 5MB 이하여야 합니다.");return}if(!t.type.startsWith("image/")){l("이미지 파일만 업로드 가능합니다.");return}try{d(!0),l("");const r=(t.name.split(".").pop()||"png").toLowerCase(),b=`${(t.name.split(".").slice(0,-1).join(".")||"image").normalize("NFKC").toLowerCase().replace(/[^a-z0-9._-]/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"").slice(0,60)||"image"}-${Date.now().toString(36)}.${r}`,{error:h}=await y.storage.from(a).upload(b,t,{cacheControl:"3600",upsert:!1});if(h)throw h;const{data:L}=y.storage.from(a).getPublicUrl(b);o(L.publicUrl)}catch(r){l(r.message||"이미지 업로드에 실패했습니다.")}finally{d(!1)}}},k=t=>{const r=t.target.files?.[0];r&&p(r)},i=t=>{t.preventDefault(),t.stopPropagation(),t.type==="dragenter"||t.type==="dragover"?n(!0):t.type==="dragleave"&&n(!1)},w=t=>{t.preventDefault(),t.stopPropagation(),n(!1);const r=t.dataTransfer.files?.[0];r&&p(r)},D=()=>{o("")},u=()=>a==="project-images"?"💡 권장: 1200×630px (19:10 비율) - 프로젝트 썸네일용":"💡 권장: 896×384px (7:3 비율) - 블로그 헤더용",{open:C}=$(),m=async()=>{const r=await C({bucket:a||"blog-images"});r&&o(r)};return e.jsxs("div",{className:`space-y-4 ${j}`,children:[x&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded-md",children:x}),c?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c,alt:"업로드된 이미지",className:"w-full h-64 sm:h-80 lg:h-96 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:D,className:"absolute top-2 right-2 bg-red-600 text-white p-1 rounded-full hover:bg-red-700 transition-colors",children:e.jsx(z,{size:16})}),e.jsxs("button",{type:"button",onClick:m,className:"absolute top-2 left-2 bg-white/90 dark:bg-gray-800/90 text-gray-800 dark:text-gray-200 px-2 py-1 rounded-md shadow hover:bg-white dark:hover:bg-gray-700 transition-colors flex items-center gap-1",children:[e.jsx(f,{size:14}),"라이브러리에서 선택"]})]}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium",children:u()})})]}):e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${N?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,onDragEnter:i,onDragLeave:i,onDragOver:i,onDrop:w,children:[e.jsx("input",{ref:g,type:"file",accept:"image/*",onChange:k,className:"hidden"}),v?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(I,{className:"h-8 w-8 text-blue-600 animate-spin"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"이미지 업로드 중..."})]}):e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-full",children:e.jsx(S,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"이미지를 드래그하여 업로드하거나"}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>g.current?.click(),className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 font-medium",children:"파일 선택"}),e.jsx("span",{className:"text-gray-400",children:"/"}),e.jsxs("button",{type:"button",onClick:m,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 font-medium flex items-center gap-1",children:[e.jsx(f,{size:16})," 라이브러리에서 선택"]})]})]}),e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF 최대 5MB"}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium",children:u()})]})]})]})]})};export{O as I};
