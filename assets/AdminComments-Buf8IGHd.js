import{j as e,z as p,a0 as b,m as y,f as j,Z as u,t as f}from"./ui-BLaX9ps4.js";import{r as a,a as v}from"./router-CLvrYEWH.js";import{u as N,s as o}from"./index-DjrO50vo.js";import{B as k}from"./Breadcrumb-DLoGhAph.js";import"./vendor-RGnvvjkK.js";const q=()=>{const[t,l]=a.useState([]),[c,d]=a.useState(!0),[n,i]=a.useState(""),{signOut:w,user:C}=N(),x=v();a.useEffect(()=>{m()},[]);const m=async()=>{try{d(!0),i("");const{data:s,error:r}=await o.from("comments").select(`
          *,
          post:blog_posts(title, post_no)
        `).order("created_at",{ascending:!1});if(r)throw r;l(s||[])}catch(s){i("댓글을 불러오는데 실패했습니다."),console.error("Error fetching comments:",s)}finally{d(!1)}},h=async s=>{if(confirm("정말로 이 댓글을 삭제하시겠습니까?"))try{const{error:r}=await o.from("comments").delete().eq("id",s);if(r)throw r;l(t.filter(g=>g.id!==s))}catch(r){i("댓글 삭제에 실패했습니다."),console.error("Error deleting comment:",r)}};return c?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{children:e.jsx(k,{items:[{label:"댓글 관리"}]})}),e.jsxs("div",{className:"flex justify-between items-center pb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"댓글 관리"})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:()=>x("/admin"),className:"flex items-center gap-2 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(p,{size:16}),"대시보드"]})})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n&&e.jsx("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded-md",children:n}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["댓글 목록 (",t.length,")"]})}),t.length===0?e.jsxs("div",{className:"px-6 py-12 text-center",children:[e.jsx(b,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"아직 댓글이 없습니다."})]}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:t.map(s=>e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:s.author_name}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.author_email})]}),e.jsx("div",{className:"mb-3",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:s.content})}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{size:14}),new Date(s.created_at).toLocaleDateString()]}),s.post&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{size:14}),e.jsx("button",{onClick:()=>window.open(`/blog/${s.post?.post_no}`,"_blank"),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline transition-colors",title:"새 탭에서 포스트 보기",children:s.post.title})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>h(s.id),className:"p-2 text-red-600 hover:text-red-700 transition-colors",title:"삭제",children:e.jsx(f,{size:16})})})]})},s.id))})]})]})]})};export{q as default};
