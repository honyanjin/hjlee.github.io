import{j as e}from"./ui-B0H31a0Z.js";import{b as y,a as j,r as s}from"./router-CLvrYEWH.js";import{P as v}from"./PartnerLayout-B8DJI2Yh.js";import{I as w}from"./ImageLibraryContext-f6LxV_De.js";import{R as N}from"./RichTextEditor-Dv9qES79.js";import{u as k,s as u}from"./index-BLqIClZs.js";import"./vendor-RGnvvjkK.js";import"./storage-17XRodAh.js";const T=()=>{const{userId:g}=y(),d=j(),{user:r}=k(),[i,h]=s.useState(""),[n,b]=s.useState(""),[l,c]=s.useState(!1),[m,a]=s.useState(""),f=async()=>{if(!r||g!==r.id){a("권한이 없습니다.");return}if(!i.trim()||!n.trim()){a("제목과 내용을 입력하세요");return}try{c(!0),a("");const{data:t,error:x}=await u.from("partner_pages").insert({title:i,content:n,is_published:!0}).select("id").single();if(x)throw x;const o=t?.id;if(o){const{error:p}=await u.from("partner_page_assignments").insert({user_id:r.id,page_id:o});if(p)throw p;d(`/partner/pages/${r.id}/${o}`,{replace:!0})}}catch(t){a(t.message||"생성 실패")}finally{c(!1)}};return e.jsx(w,{children:e.jsx(v,{children:e.jsxs("div",{className:"px-4 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"새 파트너 페이지"}),m&&e.jsx("div",{className:"mb-3 text-sm text-red-600 dark:text-red-400",children:m}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"제목",value:i,onChange:t=>h(t.target.value),className:"w-full rounded border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 px-3 py-2 text-sm"}),e.jsx(N,{value:n,onChange:b,height:400}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:()=>d(-1),className:"px-3 py-2 rounded bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 text-sm",children:"취소"}),e.jsx("button",{onClick:f,disabled:l,className:"px-3 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white text-sm disabled:opacity-50",children:l?"생성 중...":"생성"})]})]})]})})})};export{T as default};
