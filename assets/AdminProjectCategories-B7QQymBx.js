import{j as e,H as q,m as n,I as A,X as I,R as T,x as p,K as D,u as H}from"./ui-B0H31a0Z.js";import{r as o,a as R,c as $}from"./router-CLvrYEWH.js";import{a as K,b as L,s as c,o as V,n as W,c as i}from"./index-BLqIClZs.js";import{B as X}from"./Breadcrumb-CYQHPn83.js";import"./vendor-RGnvvjkK.js";const G=V({name:i().min(2,"카테고리명은 2글자 이상이어야 합니다"),slug:i().min(2,"슬러그는 2글자 이상이어야 합니다").regex(/^[a-z0-9-]+$/,"영문 소문자, 숫자, 하이픈만 사용 가능합니다"),description:i().optional(),color:i().regex(/^#[0-9A-F]{6}$/i,"올바른 색상 코드를 입력하세요 (예: #3B82F6)"),icon:i().optional(),sort_order:W().min(0,"순서는 0 이상이어야 합니다")}),Y=()=>{const[y,w]=o.useState([]),[C,j]=o.useState(!0),[f,x]=o.useState(""),[d,m]=o.useState(null),[N,g]=o.useState(!1),_=R(),[k]=$(),{register:a,handleSubmit:S,formState:{errors:t},reset:v,setValue:l,watch:z}=K({resolver:L(G)}),E=z("color","#3B82F6");o.useEffect(()=>{u(),k.get("new")==="true"&&b()},[k]);const u=async()=>{try{j(!0);const{data:r,error:s}=await c.from("project_categories").select("*").order("sort_order",{ascending:!0}).order("created_at",{ascending:!1});if(s)throw s;w(r||[])}catch(r){x("카테고리를 불러오는데 실패했습니다."),console.error("Error fetching categories:",r)}finally{j(!1)}},F=async r=>{try{if(d){const{error:s}=await c.from("project_categories").update({name:r.name,slug:r.slug,description:r.description,color:r.color,icon:r.icon,sort_order:r.sort_order}).eq("id",d);if(s)throw s}else{const{error:s}=await c.from("project_categories").insert([r]);if(s)throw s}await u(),h()}catch(s){x("카테고리 저장에 실패했습니다."),console.error("Error saving category:",s)}},B=r=>{m(r.id),l("name",r.name),l("slug",r.slug),l("description",r.description||""),l("color",r.color),l("icon",r.icon||""),l("sort_order",r.sort_order),g(!0)},P=async r=>{if(confirm("정말로 이 카테고리를 삭제하시겠습니까? 이 카테고리를 사용하는 프로젝트들은 카테고리가 해제됩니다."))try{const{error:s}=await c.from("project_categories").delete().eq("id",r);if(s)throw s;await u()}catch(s){x("카테고리 삭제에 실패했습니다."),console.error("Error deleting category:",s)}},h=()=>{m(null),g(!1),v()},b=()=>{m(null),g(!0),v({name:"",slug:"",description:"",color:"#3B82F6",icon:"",sort_order:0})};return C?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"pt-32 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"카테고리를 불러오는 중..."})]})})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{children:e.jsx(X,{items:[{label:"프로젝트 관리",path:"/admin/projects"},{label:"프로젝트 카테고리"}]})}),e.jsxs("div",{className:"flex justify-between items-center pb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"프로젝트 카테고리 관리"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>_("/admin"),className:"flex items-center gap-2 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(q,{size:16}),"대시보드"]}),e.jsxs(n.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:b,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(A,{size:20}),e.jsx("span",{children:"새 카테고리"})]})]})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[f&&e.jsx(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:f}),N&&e.jsxs(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:d?"카테고리 수정":"새 카테고리"}),e.jsx("button",{onClick:h,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx(I,{size:20})})]}),e.jsxs("form",{onSubmit:S(F),className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"카테고리명 *"}),e.jsx("input",{...a("name"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"예: Web Development"}),t.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"슬러그 *"}),e.jsx("input",{...a("slug"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"예: web-development"}),t.slug&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.slug.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"설명"}),e.jsx("textarea",{...a("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"카테고리에 대한 설명을 입력하세요"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"색상 *"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{...a("color"),type:"color",className:"w-12 h-10 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer",onChange:r=>l("color",r.target.value)}),e.jsx("input",{...a("color"),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"#3B82F6"})]}),t.color&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.color.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"아이콘"}),e.jsx("input",{...a("icon"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"예: globe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"정렬 순서"}),e.jsx("input",{...a("sort_order",{valueAsNumber:!0}),type:"number",min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"0"}),t.sort_order&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.sort_order.message})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 rounded-full",style:{backgroundColor:E}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"미리보기"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"프로젝트 목록에서 이 색상이 사용됩니다"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"취소"}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(T,{size:16}),e.jsx("span",{children:d?"수정":"생성"})]})]})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map((r,s)=>e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white",style:{backgroundColor:r.color},children:r.icon?e.jsx(p,{size:16}):e.jsx(p,{size:16})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:r.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.slug})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>B(r),className:"p-2 text-gray-600 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 transition-colors",children:e.jsx(D,{size:16})}),e.jsx("button",{onClick:()=>P(r.id),className:"p-2 text-gray-600 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 transition-colors",children:e.jsx(H,{size:16})})]})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:r.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["순서: ",r.sort_order]}),e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:r.color}})]})]},r.id))}),y.length===0&&!N&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{size:48,className:"text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"카테고리가 없습니다"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"첫 번째 카테고리를 생성해보세요."}),e.jsx("button",{onClick:b,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"카테고리 생성"})]})]})]})};export{Y as default};
