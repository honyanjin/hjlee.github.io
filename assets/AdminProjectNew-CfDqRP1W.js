import{j as e,p as F,E,G as I,J as L,I as U}from"./ui-E6zqGgdH.js";import{r as l,a as z}from"./router-CLvrYEWH.js";import{u as A,s as h,a as C,b as R,o as G,c as y,n as B,d,l as f}from"./index-C5xTZS0r.js";import{B as T}from"./Breadcrumb-DhjgP5dH.js";import{I as D}from"./ImageUpload-CXcJJW2H.js";import"./vendor-RGnvvjkK.js";const H=G({title:d().min(1,"제목을 입력해주세요"),description:d().min(10,"설명은 10자 이상이어야 합니다"),category:d().min(1,"카테고리를 선택해주세요"),tags:d().optional(),live_url:d().url().optional().or(f("")),github_url:d().url().optional().or(f("")),featured:y(),sort_order:B().min(0,"순서는 0 이상이어야 합니다"),is_published:y()}),Q=()=>{const[c,n]=l.useState(!1),[m,g]=l.useState(""),[x,u]=l.useState(""),[b,j]=l.useState(""),[k,N]=l.useState([]),{user:J}=A(),o=z();l.useEffect(()=>{v()},[]);const v=async()=>{try{const{data:r,error:a}=await h.from("project_categories").select("*").order("sort_order",{ascending:!0}).order("name",{ascending:!0});if(a)throw a;N(r||[])}catch(r){console.error("Error fetching categories:",r)}},{register:s,handleSubmit:w,formState:{errors:t}}=C({resolver:R(H),defaultValues:{featured:!1,sort_order:0,is_published:!1}}),_=async r=>{n(!0),g(""),u("");try{const a=r.tags?r.tags.split(",").map(i=>i.trim()).filter(i=>i.length>0):[],S={title:r.title,description:r.description,category:r.category,tags:a,image_url:b,live_url:r.live_url||void 0,github_url:r.github_url||void 0,featured:r.featured,sort_order:r.sort_order,is_published:r.is_published},{error:p}=await h.from("projects").insert(S);if(p)throw p;u("프로젝트가 성공적으로 저장되었습니다!"),setTimeout(()=>{o("/admin/projects")},2e3)}catch(a){g(a.message||"프로젝트 저장에 실패했습니다.")}finally{n(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{children:e.jsx(T,{items:[{label:"프로젝트 관리",path:"/admin/projects"},{label:"새 프로젝트 작성"}]})}),e.jsx("div",{className:"flex justify-between items-center pb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>o("/admin/projects"),className:"flex items-center gap-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:[e.jsx(F,{size:16}),"목록으로"]}),e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"새 프로젝트 추가"})})]})})]})}),e.jsxs("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[m&&e.jsx("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded-md",children:m}),x&&e.jsx("div",{className:"mb-6 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-600 dark:text-green-400 px-4 py-3 rounded-md",children:x}),e.jsxs("form",{onSubmit:w(_),className:"space-y-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"기본 정보"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"프로젝트 제목 *"}),e.jsx("input",{...s("title"),type:"text",id:"title",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"프로젝트 제목을 입력하세요"}),t.title&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.title.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"카테고리 *"}),e.jsxs("select",{...s("category"),id:"category",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",children:[e.jsx("option",{value:"",children:"카테고리 선택"}),k.map(r=>e.jsx("option",{value:r.name,children:r.name},r.id))]}),t.category&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.category.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sort_order",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"정렬 순서"}),e.jsx("input",{...s("sort_order",{valueAsNumber:!0}),type:"number",id:"sort_order",min:"0",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"0"}),t.sort_order&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.sort_order.message})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"프로젝트 설명 *"}),e.jsx("textarea",{...s("description"),id:"description",rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"프로젝트에 대한 상세한 설명을 입력하세요"}),t.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.description.message})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"기술 스택"}),e.jsx("input",{...s("tags"),type:"text",id:"tags",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"사용된 기술을 쉼표로 구분하여 입력하세요 (예: React, TypeScript, Node.js)"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"링크"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"live_url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(E,{size:16,className:"inline mr-2"}),"라이브 사이트 URL"]}),e.jsx("input",{...s("live_url"),type:"url",id:"live_url",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"https://example.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"github_url",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(I,{size:16,className:"inline mr-2"}),"GitHub URL"]}),e.jsx("input",{...s("github_url"),type:"url",id:"github_url",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white",placeholder:"https://github.com/username/repo"})]})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"프로젝트 이미지"}),e.jsx(D,{onImageUpload:j,currentImage:b,bucketName:"project-images"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"설정"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{...s("featured"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx(L,{size:16,className:"text-yellow-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"대표 프로젝트로 설정 (홈페이지에 표시)"})]})}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{...s("is_published"),type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"즉시 발행"})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>o("/admin/projects"),className:"px-6 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"취소"}),e.jsxs("button",{type:"submit",disabled:c,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(U,{size:16}),c?"저장 중...":"저장"]})]})]})]})]})};export{Q as default};
