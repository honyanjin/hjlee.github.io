import{j as e,z as D,m as d,H as I,X as T,O as A,w as p,I as H,t as L}from"./ui-BLaX9ps4.js";import{r as i,a as R,c as _}from"./router-CLvrYEWH.js";import{a as $,b as O,s as c,o as V,d as o}from"./index-DZNrztJB.js";import{B as X}from"./Breadcrumb-DLoGhAph.js";import"./vendor-RGnvvjkK.js";const G=V({name:o().min(2,"카테고리명은 2글자 이상이어야 합니다"),slug:o().min(2,"슬러그는 2글자 이상이어야 합니다").regex(/^[a-z0-9-]+$/,"영문 소문자, 숫자, 하이픈만 사용 가능합니다"),description:o().optional(),color:o().regex(/^#[0-9A-F]{6}$/i,"올바른 색상 코드를 입력하세요 (예: #3B82F6)"),icon:o().optional()}),W=()=>{const[y,v]=i.useState([]),[C,j]=i.useState(!0),[f,x]=i.useState(""),[n,m]=i.useState(null),[N,g]=i.useState(!1),S=R(),[k]=_(),{register:t,handleSubmit:z,formState:{errors:a},reset:w,setValue:l,watch:E}=$({resolver:O(G)}),F=E("color","#3B82F6");i.useEffect(()=>{h(),k.get("new")==="true"&&b()},[k]);const h=async()=>{try{j(!0);const{data:r,error:s}=await c.from("categories").select("*").order("created_at",{ascending:!1});if(s)throw s;v(r||[])}catch(r){x("카테고리를 불러오는데 실패했습니다."),console.error("Error fetching categories:",r)}finally{j(!1)}},B=async r=>{try{if(n){const{error:s}=await c.from("categories").update({name:r.name,slug:r.slug,description:r.description,color:r.color,icon:r.icon}).eq("id",n);if(s)throw s}else{const{error:s}=await c.from("categories").insert([r]);if(s)throw s}await h(),u()}catch(s){x("카테고리 저장에 실패했습니다."),console.error("Error saving category:",s)}},P=r=>{m(r.id),l("name",r.name),l("slug",r.slug),l("description",r.description||""),l("color",r.color),l("icon",r.icon||""),g(!0)},q=async r=>{if(confirm("정말로 이 카테고리를 삭제하시겠습니까?"))try{const{error:s}=await c.from("categories").delete().eq("id",r);if(s)throw s;await h()}catch(s){x("카테고리 삭제에 실패했습니다."),console.error("Error deleting category:",s)}},u=()=>{m(null),g(!1),w()},b=()=>{m(null),g(!0),w({name:"",slug:"",description:"",color:"#3B82F6",icon:""})};return C?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{children:e.jsx(X,{items:[{label:"블로그 관리",path:"/admin/blog"},{label:"포스트 카테고리 관리"}]})}),e.jsxs("div",{className:"flex justify-between items-center pb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"포스트 카테고리 관리"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>S("/admin"),className:"flex items-center gap-2 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(D,{size:16}),"대시보드"]}),e.jsxs(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:b,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(I,{size:20}),e.jsx("span",{children:"새 카테고리"})]})]})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[f&&e.jsx(d.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:f}),N&&e.jsxs(d.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:n?"카테고리 수정":"새 카테고리"}),e.jsx("button",{onClick:u,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx(T,{size:20})})]}),e.jsxs("form",{onSubmit:z(B),className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"카테고리명 *"}),e.jsx("input",{...t("name"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"예: React"}),a.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"슬러그 *"}),e.jsx("input",{...t("slug"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"예: react"}),a.slug&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.slug.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"설명"}),e.jsx("textarea",{...t("description"),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"카테고리에 대한 설명을 입력하세요"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"색상 *"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{...t("color"),type:"color",className:"w-12 h-10 border border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer",onChange:r=>l("color",r.target.value)}),e.jsx("input",{...t("color"),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"#3B82F6"})]}),a.color&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.color.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"아이콘"}),e.jsx("input",{...t("icon"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"예: react"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 rounded-full",style:{backgroundColor:F}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"미리보기"}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"블로그 포스트에서 이 색상이 사용됩니다"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:u,className:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"취소"}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(A,{size:16}),e.jsx("span",{children:n?"수정":"생성"})]})]})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map((r,s)=>e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:s*.1},className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white",style:{backgroundColor:r.color},children:r.icon?e.jsx(p,{size:16}):e.jsx(p,{size:16})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:r.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.slug})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>P(r),className:"p-2 text-gray-600 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400 transition-colors",children:e.jsx(H,{size:16})}),e.jsx("button",{onClick:()=>q(r.id),className:"p-2 text-gray-600 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400 transition-colors",children:e.jsx(L,{size:16})})]})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:r.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["생성일: ",new Date(r.created_at).toLocaleDateString()]}),e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:r.color}})]})]},r.id))}),y.length===0&&!N&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{size:48,className:"text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"카테고리가 없습니다"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"첫 번째 카테고리를 생성해보세요."}),e.jsx("button",{onClick:b,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"카테고리 생성"})]})]})]})};export{W as default};
