import{j as e}from"./ui-B0H31a0Z.js";import{b as k,a as N,r as t}from"./router-CLvrYEWH.js";import{P as w}from"./PartnerLayout-B8DJI2Yh.js";import{I as S}from"./ImageLibraryContext-f6LxV_De.js";import{u as P,s as p}from"./index-BLqIClZs.js";import{R as E}from"./RichTextEditor-Dv9qES79.js";import"./vendor-RGnvvjkK.js";import"./storage-17XRodAh.js";const H=()=>{const{pageId:a,userId:f}=k();N();const[d,y]=t.useState(""),[i,l]=t.useState(""),[b,c]=t.useState(!0),[g,r]=t.useState(""),[j,o]=t.useState(!1),[x,m]=t.useState(!1),{user:u}=P();t.useEffect(()=>{a&&(async()=>{try{c(!0);const{data:n,error:h}=await p.from("partner_pages").select("title, content").eq("id",a).maybeSingle();if(h){r(h.message||"데이터 로딩 오류");return}if(!n){r("페이지를 찾을 수 없습니다.");return}y(n.title),l(n.content),r("")}catch(n){r(n?.message||"페이지를 불러오는 중 오류가 발생했습니다.")}finally{c(!1)}})()},[a]);const v=async()=>{if(a)try{m(!0);const{error:s}=await p.from("partner_pages").update({content:i}).eq("id",a);if(s)throw s;o(!1)}catch(s){r(s.message||"저장 실패")}finally{m(!1)}};return e.jsx(S,{children:e.jsx(w,{children:e.jsx("div",{className:"px-4 max-w-4xl mx-auto",children:b?e.jsx("div",{className:"text-gray-700 dark:text-gray-300",children:"로딩 중..."}):g?e.jsx("div",{className:"text-red-600 dark:text-red-400",children:g}):j?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 sm:p-6",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-4",children:d}),e.jsx(E,{value:i,onChange:l,height:500}),e.jsxs("div",{className:"mt-4 flex gap-2 justify-end",children:[e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 rounded bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200",children:"취소"}),e.jsx("button",{onClick:v,disabled:x,className:"px-4 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white disabled:opacity-50",children:x?"저장 중...":"저장"})]})]}):e.jsxs("article",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:d}),u&&f===u.id&&e.jsx("button",{onClick:()=>o(!0),className:"px-3 py-2 rounded bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-sm text-gray-800 dark:text-gray-200",children:"수정"})]}),e.jsx("div",{className:"prose dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:i}})]})})})})};export{H as default};
