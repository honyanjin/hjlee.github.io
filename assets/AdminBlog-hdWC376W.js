import{j as e,H as w,x as h,I as v,m as N,U as k,f as _,z as C,h as z,J as D,K as E,u as S}from"./ui-B0H31a0Z.js";import{r as d,a as P}from"./router-CLvrYEWH.js";import{s as o}from"./index-b5FANDsy.js";import{B as q}from"./Breadcrumb-CYQHPn83.js";import"./vendor-RGnvvjkK.js";const R=()=>{const[a,l]=d.useState([]),[b,m]=d.useState(!0),[g,n]=d.useState(""),i=P();d.useEffect(()=>{u()},[]);const u=async()=>{try{m(!0);const{data:r,error:t}=await o.from("blog_posts").select("*").order("published_at",{ascending:!1}).order("created_at",{ascending:!1});if(t)throw t;const s=(r||[]).sort((c,x)=>{const f=c.published_at?new Date(c.published_at):new Date(c.created_at);return(x.published_at?new Date(x.published_at):new Date(x.created_at)).getTime()-f.getTime()});l(s)}catch(r){n("포스트를 불러오는데 실패했습니다."),console.error("Error fetching posts:",r)}finally{m(!1)}},y=async r=>{if(confirm("정말로 이 포스트를 삭제하시겠습니까?"))try{const{error:t}=await o.from("blog_posts").delete().eq("id",r);if(t)throw t;l(a.filter(s=>s.id!==r))}catch(t){n("포스트 삭제에 실패했습니다."),console.error("Error deleting post:",t)}},p=async r=>{try{const{error:t}=await o.from("blog_posts").update({is_published:!r.is_published,published_at:r.is_published?null:new Date().toISOString()}).eq("id",r.id);if(t)throw t;l(a.map(s=>s.id===r.id?{...s,is_published:!s.is_published}:s))}catch(t){n("포스트 상태 변경에 실패했습니다."),console.error("Error updating post:",t)}},j=async r=>{try{const{error:t}=await o.from("blog_posts").update({is_recommended:!r.is_recommended}).eq("id",r.id);if(t)throw t;l(a.map(s=>s.id===r.id?{...s,is_recommended:!s.is_recommended}:s))}catch(t){n("추천 상태 변경에 실패했습니다."),console.error("Error updating recommendation:",t)}};return b?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{children:e.jsx(q,{items:[{label:"블로그 관리",path:"/admin/blog"}]})}),e.jsxs("div",{className:"flex justify-between items-center pb-6",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"블로그 관리"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>i("/admin"),className:"flex items-center gap-2 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(w,{size:16}),"대시보드"]}),e.jsxs("button",{onClick:()=>i("/admin/blog/categories"),className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(h,{size:16}),"포스트 카테고리"]}),e.jsxs("button",{onClick:()=>i("/admin/blog/new"),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(v,{size:16}),"새 포스트"]})]})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[g&&e.jsx("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded-md",children:g}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["포스트 목록 (",a.length,")"]})}),a.length===0?e.jsxs("div",{className:"px-6 py-12 text-center",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"아직 포스트가 없습니다."}),e.jsx("button",{onClick:()=>i("/admin/blog/new"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"첫 포스트 작성하기"})]}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:a.map(r=>e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 shrink-0",children:e.jsx("span",{className:"inline-flex items-center justify-center w-12 px-2 py-1 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs font-mono",title:"Post No",children:r.post_no})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors truncate",onClick:()=>i(`/blog/${r.post_no}`),title:"포스트 보기",children:r.title}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${r.is_published?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}`,children:r.is_published?"발행됨":"임시저장"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{size:14}),r.author]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{size:14}),new Date(r.created_at).toLocaleDateString()]}),r.tags&&r.tags.length>0&&e.jsxs("div",{className:"flex items-center gap-1 truncate",children:[e.jsx(h,{size:14}),e.jsx("span",{className:"truncate max-w-[400px]",children:r.tags.join(", ")})]})]})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("button",{onClick:()=>p(r),className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",title:r.is_published?"발행 취소":"발행",children:r.is_published?e.jsx(C,{size:16}):e.jsx(z,{size:16})}),e.jsx("button",{onClick:()=>j(r),className:`p-2 transition-colors ${r.is_recommended?"text-yellow-500 hover:text-yellow-600":"text-gray-400 hover:text-yellow-500"}`,title:r.is_recommended?"추천 해제":"추천",children:e.jsx(D,{size:16,fill:r.is_recommended?"currentColor":"none"})}),e.jsx("button",{onClick:()=>i(`/admin/blog/edit/${r.id}`),className:"p-2 text-blue-600 hover:text-blue-700 transition-colors",title:"편집",children:e.jsx(E,{size:16})}),e.jsx("button",{onClick:()=>y(r.id),className:"p-2 text-red-600 hover:text-red-700 transition-colors",title:"삭제",children:e.jsx(S,{size:16})})]})]})},r.id))})]})]})]})};export{R as default};
