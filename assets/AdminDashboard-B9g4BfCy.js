import{j as e,m as a,K as g,F as R,a as E,T as L,$ as f,O as N,N as $}from"./ui-DCVn0oQs.js";import{r as h,a as A}from"./router-CLvrYEWH.js";import{u as H,s as c,A as v}from"./index-BJQaA9zI.js";import"./vendor-RGnvvjkK.js";const G=()=>{const[s,w]=h.useState({totalPosts:0,publishedPosts:0,draftPosts:0,totalProjects:0,publishedProjects:0,featuredProjects:0,totalCategories:0,totalProjectCategories:0,totalComments:0,recentPosts:[],recentProjects:[],recentComments:[]}),[k,p]=h.useState(!0),[j,b]=h.useState(""),{signOut:F,user:O}=H(),r=A();h.useEffect(()=>{P()},[]);const P=async()=>{p(!0),b("");const t=async(l,d=8e3)=>await Promise.race([l,new Promise((o,n)=>setTimeout(()=>n(new Error("timeout")),d))]);try{const[l,d,o,n,u]=await Promise.allSettled([t(Promise.resolve(c.from("blog_posts").select("*").order("created_at",{ascending:!1}))),t(Promise.resolve(c.from("projects").select("*").order("created_at",{ascending:!1}))),t(Promise.resolve(c.from("categories").select("*"))),t(Promise.resolve(c.from("project_categories").select("*"))),t(Promise.resolve(c.from("comments").select("*").order("created_at",{ascending:!1})))]),x=l.status==="fulfilled"&&"data"in l.value?l.value.data:[],m=d.status==="fulfilled"&&"data"in d.value?d.value.data:[],C=o.status==="fulfilled"&&"data"in o.value?o.value.data:[],_=n.status==="fulfilled"&&"data"in n.value?n.value.data:[],y=u.status==="fulfilled"&&"data"in u.value?u.value.data:[],S=(x||[]).filter(i=>i.is_published),D=(x||[]).filter(i=>!i.is_published),T=(m||[]).filter(i=>i.is_published),z=(m||[]).filter(i=>i.featured);w({totalPosts:x?.length||0,publishedPosts:S.length,draftPosts:D.length,totalProjects:m?.length||0,publishedProjects:T.length,featuredProjects:z.length,totalCategories:C?.length||0,totalProjectCategories:_?.length||0,totalComments:y?.length||0,recentPosts:(x||[]).slice(0,5),recentProjects:(m||[]).slice(0,5),recentComments:(y||[]).slice(0,5)})}catch(l){console.error("Dashboard load error:",l),b("대시보드 데이터 로딩이 지연되거나 실패했습니다. 잠시 후 다시 시도하세요.")}finally{p(!1)}};return k?e.jsx(v,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})})}):e.jsx(v,{children:e.jsxs("div",{className:"p-8",children:[j&&e.jsx("div",{className:"mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded-md",children:j}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"포트폴리오 관리 현황을 한눈에 확인하세요"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"빠른 작업"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(a.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r("/admin/blog/new"),className:"flex items-center gap-3 p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[e.jsx(g,{size:20}),e.jsx("span",{children:"새 포스트"})]}),e.jsxs(a.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r("/admin/projects/new"),className:"flex items-center gap-3 p-4 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:[e.jsx(g,{size:20}),e.jsx("span",{children:"새 프로젝트"})]}),e.jsxs(a.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r("/admin/blog/categories?new=true"),className:"flex items-center gap-3 p-4 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[e.jsx(g,{size:20}),e.jsx("span",{children:"새 포스트 카테고리"})]}),e.jsxs(a.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>r("/admin/projects/categories?new=true"),className:"flex items-center gap-3 p-4 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors",children:[e.jsx(g,{size:20}),e.jsx("span",{children:"새 프로젝트 카테고리"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"통계"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"총 포스트"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.totalPosts})]}),e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-full",children:e.jsx(R,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})})]}),e.jsxs("div",{className:"mt-4 flex gap-2 text-sm",children:[e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["발행: ",s.publishedPosts]}),e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:["임시저장: ",s.draftPosts]})]})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"총 프로젝트"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.totalProjects})]}),e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900 rounded-full",children:e.jsx(E,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})})]}),e.jsxs("div",{className:"mt-4 flex gap-2 text-sm",children:[e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:["발행: ",s.publishedProjects]}),e.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:["대표: ",s.featuredProjects]})]})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"카테고리"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.totalCategories+s.totalProjectCategories})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900 rounded-full",children:e.jsx(L,{className:"h-6 w-6 text-green-600 dark:text-green-400"})})]}),e.jsxs("div",{className:"mt-4 flex gap-2 text-sm",children:[e.jsxs("span",{className:"text-blue-600 dark:text-blue-400",children:["블로그: ",s.totalCategories]}),e.jsxs("span",{className:"text-purple-600 dark:text-purple-400",children:["프로젝트: ",s.totalProjectCategories]})]})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"총 댓글"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.totalComments})]}),e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900 rounded-full",children:e.jsx(f,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})})]}),e.jsx("div",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400",children:"최근 24시간 활동"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(a.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},className:"bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"최근 포스트"}),e.jsx("button",{onClick:()=>r("/admin/blog"),className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"모두 보기"})]})}),e.jsx("div",{className:"p-6",children:s.recentPosts.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"아직 포스트가 없습니다."}):e.jsx("div",{className:"space-y-4",children:s.recentPosts.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.is_published?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}`,children:t.is_published?"발행":"임시저장"}),e.jsx("button",{onClick:()=>r(`/admin/blog/edit/${t.id}`),className:"p-1 text-blue-600 hover:text-blue-700",children:e.jsx(N,{size:14})})]})]},t.id))})})]}),e.jsxs(a.div,{initial:{opacity:0,x:0},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},className:"bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"최근 프로젝트"}),e.jsx("button",{onClick:()=>r("/admin/projects"),className:"text-purple-600 hover:text-purple-700 text-sm font-medium",children:"모두 보기"})]})}),e.jsx("div",{className:"p-6",children:s.recentProjects.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"아직 프로젝트가 없습니다."}):e.jsx("div",{className:"space-y-4",children:s.recentProjects.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.featured&&e.jsx($,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.is_published?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}`,children:t.is_published?"발행":"임시저장"}),e.jsx("button",{onClick:()=>r(`/admin/projects/edit/${t.id}`),className:"p-1 text-purple-600 hover:text-purple-700",children:e.jsx(N,{size:14})})]})]},t.id))})})]}),e.jsxs(a.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"최근 댓글"}),e.jsx("button",{onClick:()=>r("/admin/comments"),className:"text-pink-600 hover:text-pink-700 text-sm font-medium",children:"모두 보기"})]})}),e.jsx("div",{className:"p-6",children:s.recentComments.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"아직 댓글이 없습니다."}):e.jsx("div",{className:"space-y-4",children:s.recentComments.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.author_name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:t.content}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsx("button",{onClick:()=>r("/admin/comments"),className:"p-1 text-pink-600 hover:text-pink-700",children:e.jsx(f,{size:14})})]},t.id))})})]})]})]})})};export{G as default};
